# 001-UI-Redesign: 转写结果页面

## 概述

创建一个独立的转写结果展示页面，参考阿里云通义听悟的交互设计，实现视频/音频播放与字幕的双向联动。

## 功能需求

### 1. 页面布局

```
┌─────────────────────────────────────────────────────────────┐
│ [标题]                                    [导出▼] [编辑字幕] │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│                    视频/音频播放器                            │
│                  (音频时显示黑色背景)                          │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │              当前字幕 (视频叠加层)                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ▶️ ━━━━━━━━━━●━━━━━━━━━━━━━━━━━ 03:24 / 12:30            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  👤 发言人 1  00:00                                         │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 最近很多人在讨论AI的buffer...                          │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  👤 发言人 2  00:05                                         │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 觉得至少三年之内看不到泡沫...                           │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2. 视频/音频播放器

- **视频模式**: 正常显示视频画面，字幕叠加在视频底部
- **音频模式**: 显示黑色/深色背景，字幕为白色显示在画面中央
- **播放控制**:
  - 播放/暂停按钮
  - 进度条 (可拖拽)
  - 当前时间 / 总时长
  - 音量控制
  - 全屏按钮

### 3. 字幕区域

- 显示完整的转写文本，按发言人和时间戳分段
- **当前播放的字幕高亮显示** (类似通义听悟的紫色/蓝色背景)
- 每个字幕段显示:
  - 发言人头像/图标
  - 发言人标签 (发言人 1, 发言人 2...)
  - 时间戳 (MM:SS 格式)
  - 文本内容

### 4. 双向联动

#### 4.1 播放器 → 字幕
- 播放进度变化时，自动滚动到对应字幕
- 当前播放的字幕高亮显示
- 视频叠加层同步显示当前字幕

#### 4.2 字幕 → 播放器
- 点击任意字幕段，播放器跳转到对应时间点
- 跳转后自动开始播放

### 5. 导出功能

右上角导出按钮，支持三种格式:
- **TXT**: 纯文本格式，包含时间戳和发言人
- **SRT**: 标准字幕格式
- **MD**: Markdown 格式 (当前实现)

导出时弹出下拉菜单选择格式，点击后直接下载文件。

### 6. 编辑字幕功能

- 点击"编辑字幕"按钮进入编辑模式
- 可直接修改字幕文本内容
- 保存后更新显示 (本地存储)
- 取消则恢复原内容

## 技术实现

### 文件结构

```
src/podscript_api/static/
├── index.html          # 主页 (上传/转写)
├── result.html         # 转写结果页面 (新增)
├── styles.css          # 主页样式
├── result.css          # 结果页样式 (新增)
├── app.js              # 主页逻辑
└── result.js           # 结果页逻辑 (新增)
```

### 数据流

1. 转写完成后，主页跳转到 `/result.html?task_id={id}`
2. 结果页通过 API 获取:
   - `GET /tasks/{id}` - 任务信息 (包含音频/视频文件路径)
   - `GET /tasks/{id}/results` - 转写结果 (SRT, MD 路径)
   - `GET /artifacts/{id}/audio.mp3` - 音频文件
   - `GET /artifacts/{id}/result.json` - 结构化字幕数据

### API 扩展

需要新增接口返回结构化字幕数据:

```json
GET /tasks/{id}/transcript

{
  "segments": [
    {
      "id": 1,
      "start": 0.0,
      "end": 5.2,
      "text": "最近很多人在讨论AI的buffer...",
      "speaker": "1"
    },
    ...
  ],
  "media_url": "/artifacts/{id}/audio.mp3",
  "media_type": "audio",
  "title": "任务标题",
  "duration": 750.5
}
```

## 设计规范

遵循 `claude-design-spec.md` 中的 Claude/Anthropic 设计风格:

- **背景色**: #FAF9F5 (暖纸色)
- **强调色**: #DA7756 (赭橙) - 用于当前播放字幕高亮
- **字幕高亮**: 使用蓝紫色渐变背景 (#6366f1 → #8b5cf6)，参考通义听悟
- **卡片圆角**: 叶片形状非对称圆角
- **字体**: Inter (正文) + Georgia (标题)

## 参考

- 阿里云通义听悟 UI (见附图)
- Claude/Anthropic 设计规范 (`claude-design-spec.md`)

## 验收标准

- [ ] 视频/音频正常播放
- [ ] 字幕与播放进度同步
- [ ] 点击字幕跳转到对应时间
- [ ] 点击进度条跳转并同步字幕
- [ ] 导出 TXT/SRT/MD 格式正常
- [ ] 编辑字幕功能可用
- [ ] 响应式布局 (移动端适配)
- [ ] 符合 Claude 设计规范
